# Conditionally enable profiling
if [[ -n "$ZSH_PROFILER" ]]; then
    zmodload zsh/zprof
fi

# ~/.zshrc
ZSH_DIR="$HOME/.config/zsh"

# Add to PATH only if not already present
path_prepend() { [[ ":$PATH:" != *":$1:"* ]] && export PATH="$1:$PATH"; }
path_append()  { [[ ":$PATH:" != *":$1:"* ]] && export PATH="$PATH:$1"; }

# Base
source "$ZSH_DIR/launch.zsh"
source "$ZSH_DIR/exports.zsh"
source "$ZSH_DIR/aliases.zsh"
# Bindings & general
source "$ZSH_DIR/general.zsh"
# Functions
source "$ZSH_DIR/functions.zsh"
# Zinit plugins
source "$ZSH_DIR/plugins.zsh"


# Custom functions/plugins/themes
# for file in "$ZSH_DIR/custom/"*.zsh; do
#   source "$file"
# done

# Prompt/theme
source "$ZSH_DIR/theme.zsh"

if [[ -n "$ZSH_PROFILER" ]]; then
    zprof
fi

autoload -U +X bashcompinit && bashcompinit
complete -o nospace -C /opt/homebrew/bin/terraform terraform

# bun completions
[ -s "/Users/zaid/.bun/_bun" ] && source "/Users/zaid/.bun/_bun"

# bun
export BUN_INSTALL="$HOME/.bun"
path_prepend "$BUN_INSTALL/bin"

# Zsh config change watcher
source "$ZSH_DIR/zsh-config-watcher.zsh"
